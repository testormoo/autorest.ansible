@using AutoRest.Ansible.Templates
@using System.Linq
@using AutoRest.Core.Model
@using AutoRest.Core.Utilities
@using AutoRest.Ansible
@using AutoRest.Ansible.Model
@inherits AutoRest.Ansible.PythonTemplate<AutoRest.Ansible.Model.CodeModelAnsibleMap>
- name: Prepare random number
  set_fact:
    rpfx: "{{ 1000 | random }}{{ resource_group | hash('md5') | truncate(7, True, '') }}"
  run_once: yes
@if (Model.HasPrerequisites())
{
@EmptyLine
    foreach (var line in Model.ModuleTestPrerequisites)
    {
@:@(line)
    }
}
@for (int testIdx = 0; testIdx < Model.GetModuleFactTestCount(); testIdx++)
{
@EmptyLine
foreach (var line in Model.GetModuleFactTest(testIdx))
{
@:@(line)
}
@:  register: output
@:- name: Assert that facts are returned
@:  assert:
@:    that:
@:      - output.changed == False
@:      - output.@(Model.ModuleOperationName + "." + Model.FindResourceNameInTest()).id != None
}
@if (Model.HasPrerequisites())
{
@EmptyLine
    foreach (var line in Model.ModuleTestDeleteClearPrerequisites)
    {
@:@(line)
    }
}
